<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>CORE - Sistema RP</title>

<style>
* {
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  margin: 0;
  height: 100vh;
  background: #000;
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* TELAS */
.tela {
  display: none;
  width: 320px;
  text-align: center;
}

.tela.active {
  display: block;
}

h1 {
  letter-spacing: 4px;
}

input {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
  border: none;
}

button {
  width: 100%;
  padding: 12px;
  margin-top: 8px;
  border: none;
  cursor: pointer;
  background: #ccc;
  font-weight: bold;
}

.btn-verde {
  background: #00ff88;
}

.btn-vermelho {
  background: #ff4d4d;
  color: white;
}

.erro {
  color: #ff4d4d;
  font-size: 14px;
  margin-top: 6px;
  display: none;
}

.lista {
  background: #111;
  padding: 10px;
  margin-top: 10px;
  text-align: left;
  max-height: 200px;
  overflow-y: auto;
}
</style>
</head>

<body>

<!-- HOME -->
<div class="tela active" id="home">
  <h1>CORE</h1>
  <button onclick="trocarTela('login')">Acessar</button>
</div>

<!-- LOGIN -->
<div class="tela" id="login">
  <h2>Core Painel</h2>
  <input id="loginUser" placeholder="Usuário">
  <input id="loginPass" type="password" placeholder="Senha">
  <button class="btn-verde" onclick="login()">Entrar</button>
  <div class="erro" id="loginErro">Usuário ou senha inválidos</div>
</div>

<!-- PAINEL SUPERIOR -->
<div class="tela" id="superior">
  <h2>Painel do Superior</h2>

  <h3>Cadastrar Policial</h3>
  <input id="novoUser" placeholder="Usuário">
  <input id="novoPass" placeholder="Senha">
  <button class="btn-verde" onclick="cadastrar()">Cadastrar</button>

  <h3>Excluir Policial</h3>
  <input id="delUser" placeholder="Usuário do policial">
  <button class="btn-vermelho" onclick="excluir()">Excluir</button>

  <div class="lista" id="lista"></div>

  <button onclick="logout()">Sair</button>
</div>

<!-- PAINEL POLICIAL -->
<div class="tela" id="policial">
  <h2>Painel do Policial</h2>
  <p>Acesso padrão concedido.</p>
  <button onclick="logout()">Sair</button>
</div>

<script>
// ===== DADOS =====
let dados = JSON.parse(localStorage.getItem("coreDados")) || {
  superiores: {
    "coreCPX": "corev201"
  },
  policiais: {}
};

function salvar() {
  localStorage.setItem("coreDados", JSON.stringify(dados));
}

// ===== TELAS =====
function trocarTela(id) {
  document.querySelectorAll(".tela").forEach(t => t.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// ===== LOGIN =====
function login() {
  const u = loginUser.value;
  const p = loginPass.value;

  loginErro.style.display = "none";

  if (dados.superiores[u] === p) {
    trocarTela("superior");
    atualizarLista();
    return;
  }

  if (dados.policiais[u] === p) {
    trocarTela("policial");
    return;
  }

  loginErro.style.display = "block";
}

// ===== CADASTRAR =====
function cadastrar() {
  const u = novoUser.value;
  const p = novoPass.value;

  if (!u || !p) return;

  dados.policiais[u] = p;
  salvar();

  novoUser.value = "";
  novoPass.value = "";

  atualizarLista();
}

// ===== EXCLUIR =====
function excluir() {
  const u = delUser.value;

  if (dados.policiais[u]) {
    delete dados.policiais[u];
    salvar();
    atualizarLista();
  }
}

// ===== LISTA =====
function atualizarLista() {
  lista.innerHTML = "<b>Policiais cadastrados:</b><br><br>";

  const policiais = Object.keys(dados.policiais);

  if (policiais.length === 0) {
    lista.innerHTML += "Nenhum policial cadastrado.";
    return;
  }

  policiais.forEach(p => {
    lista.innerHTML += `• ${p}<br>`;
  });
}

// ===== LOGOUT =====
function logout() {
  trocarTela("home");
}
</script>

</body>
</html>
